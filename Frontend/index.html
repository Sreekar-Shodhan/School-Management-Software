<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Dashboard</title>
	<link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="font-sans bg-gray-100 h-screen">
	<!-- Navigation Bar -->
	<nav class="bg-white shadow">
		<div class="max-w-screen-xl mx-auto p-4">
			<div class="flex justify-between items-center">
				<div class="flex items-center space-x-3">
					<img src="https://placekitten.com/32/32" class="h-8" alt="Logo">
					<span class="text-xl font-semibold">Dashboard</span>
				</div>
				<div class="flex items-center space-x-2">
					<span class="text-gray-600">John Doe</span>
					<img src="https://placekitten.com/24/24" class="h-6 w-6 rounded-full" alt="Profile">
				</div>
			</div>
		</div>
	</nav>

	<!-- Main Content -->
	<div class="flex h-full">
		<!-- Sidebar -->
		<aside class="bg-gray-800 text-white w-64 p-4 flex flex-col">
			<ul class="space-y-2 flex-grow">
				<li class="hover:bg-gray-700 p-2 rounded">
					<a href="#" class="flex items-center space-x-2">
						<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
							<path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path>
							<path fill-rule="evenodd"
								d="M2 3a1 1 0 011-1h1a1 1 0 011 1v12a1 1 0 01-1 1H3a1 1 0 01-1-1zm16 0a1 1 0 011 1v12a1 1 0 01-1 1h-1a1 1 0 01-1-1V4a1 1 0 011-1h1z"
								clip-rule="evenodd"></path>
						</svg>
						<span>Dashboard</span>
					</a>
				</li>
				<li class="hover:bg-gray-700 p-2 rounded">
					<a href="#" class="flex items-center space-x-2">
						<!-- <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
							<path
								d="M6 3a1 1 0 100-2 1 1 0 000 2zM4 3a1 1 0 100-2 1 1 0 000 2zM16 3a1 1 0 100-2 1 1 0 000 2zM14 3a1 1 0 100-2 1 1 0 000 2zM10 3a1 1 0 100-2 1 1 0 000 2z">
							</path>
							<path
								d="M3.293 9.293a1 1 0 011.414 0L10 14.586l5.293-5.293a1 1 0 111.414 1.414l-6 6a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414z">
							</path>
						</svg> -->
						<span><a href="New-Student.html">Create New Student Information</a></span>
					</a>
				</li>
				<!-- <li class="hover:bg-gray-700 p-2 rounded">
					<a href="#" class="flex items-center space-x-2">
						<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd"
								d="M2 3a1 1 0 011-1h14a1 1 0 110 2H3a1 1 0 01-1-1zm1 5a1 1 0 100 2h14a1 1 0 100-2H3zm-1 4a1 1 0 011-1h14a1 1 0 110 2H3a1 1 0 01-1-1zm1 5a1 1 0 100 2h14a1 1 0 100-2H3z"
								clip-rule="evenodd"></path>
						</svg>
						<span>Settings</span>
					</a>
				</li> -->
			</ul>
		</aside>

		<!-- Main Content Area -->
		<main class="flex-1 p-4 space-y-8">
			<!-- Student Information -->
			<!-- <div class="bg-white p-6 rounded-md shadow-md">
				<h1 class="text-2xl font-bold text-center mb-6">Enter Student Information</h1>
				<form class="flex flex-row space-x-4 items-start">
					<label for="student-name" class="text-sm font-medium text-gray-700">Student Name:</label>
					<input type="text" id="student-name"
						class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
						required>
					<label for="phone-number" class="text-sm font-medium text-gray-700">Phone Number:</label>
					<input type="tel" id="phone-number"
						class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
						required>
					<label for="amount-paid" class="text-sm font-medium text-gray-700">Amount Paid:</label>
					<input type="text" id="amount-paid"
						class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
						required>
					<label for="payment-date" class="text-sm font-medium text-gray-700">Date of Payment:</label>
					<input type="date" id="payment-date"
						class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
						required>
					<label for="student-class" class="text-sm font-medium text-gray-700">Class:</label>
					<select id="student-class"
						class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
						required>
						<option value="" disabled selected>Select Class</option>
						<option value="grade10">Grade 10</option>
						<option value="grade11">Grade 11</option>
						<option value="grade12">Grade 12</option>
					</select>
					<button
						class="bg-blue-500 text-white font-bold rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline px-4 py-2">Submit</button>
				</form>
			</div> -->

			<!-- Student Payment Information -->
			<div class="bg-white p-6 rounded-md shadow-md">
				<h1 class="text-2xl font-bold text-center mb-6">Student Payment Information</h1>
				<form class="flex flex-row space-x-4 items-start">
					<label for="student-name" class="text-sm font-medium text-gray-700">Enter Details</label>
					<input type="text" id="search-student-name" placeholder="Enter any of the Student name, phone number, Roll number, parent name"
						class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
						required>



					<button id="search-btn"
						class="bg-blue-500 text-white font-bold rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline px-4 py-2" >Search</button>
				</form>
				<br>
				<table class="table w-full border rounded-md shadow-md">
					<thead>
						<tr class="bg-gray-200 text-gray-700 font-bold text-sm uppercase">
							<th class="px-4 py-2">Student Name</th>
							<th class="px-4 py-2">Payment Date</th>
							<th class="px-4 py-2">Amount</th>
							<th class="px-4 py-2">Class</th>
							<th class="px-4 py-2">Phone Number</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td class="px-4 py-2 border box-border text-center">John Doe</td>
							<td class="px-4 py-2 border box-border text-center">2023-12-04</td>
							<td class="px-4 py-2 border box-border text-center">$100.00</td>
							<td class="px-4 py-2 border box-border text-center">Grade 10</td>
							<td class="px-4 py-2 border box-border text-center">123-456-7890</td>
						</tr>
					</tbody>
				</table>
			</div>
		</main>
	</div>

	<script>

		const handleSubmit = async () => {
			// Assuming you have an API endpoint to submit the form data
			const apiUrl = 'http://127.0.0.1:8000/api/submit';

			// Get form values
			const studentName = document.getElementById('student-name').value;
			const phoneNumber = document.getElementById('phone-number').value;
			const amountPaid = document.getElementById('amount-paid').value;
			const paymentDate = document.getElementById('payment-date').value;
			const studentClass = document.getElementById('student-class').value;

			// Prepare the data object
			const formData = {
				studentName,
				phoneNumber,
				amountPaid,
				paymentDate,
				studentClass,
			};

			// Make a fetch request
			try {
				const response = await fetch(apiUrl, {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify(formData),
				});

				if (!response.ok) {
					throw new Error(`HTTP error! Status: ${response.status}`);
				}

				const responseData = await response.json();
				console.log('Form submitted successfully:', responseData);
			} catch (error) {
				console.error('Error submitting form:', error.message);
			}
		};

		// Add an event listener to the submit button
		document.querySelector('form').addEventListener('submit', (event) => {
			event.preventDefault(); // Prevent the default form submission
			handleSubmit(); // Call the custom submit function
		});

	// Function to handle the search submission and make a fetch request
		const handleSearch = async () => {
			 console.log('Entering handleSearch');
			// Assuming you have an API endpoint to search for student payment information
			const apiUrl = 'http://127.0.0.1:8000/api/search_payment';

			// Get search form values
			const studentName = document.getElementById('search-student-name').value;
			const phoneNumber = document.getElementById('search-phone-number').value;

			// Prepare the data object
			const searchData = {
				student_name: studentName,
				phone_number: phoneNumber,
			};

			// Make a fetch request
			try {
				console.log('Before fetch request');
				const response = await fetch(apiUrl, {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify(searchData),
				});

				if (!response.ok) {
					throw new Error(`HTTP error! Status: ${response.status}`);
				}

				const responseData = await response.json();

				// Handle the retrieved data (update UI, display results, etc.)
				console.log('Search result:', responseData);
				updateTable(responseData);
			} catch (error) {
				console.error('Error searching payment:', error.message);
			}
		};


		// Add an event listener to the search button
		document.getElementById('search-btn').addEventListener('click', (event) => {
			event.preventDefault();
			console.log('Search button clicked');
			handleSearch(); // Call the custom search function

		});


		const updateTable = (searchResult) => {
				const tableBody = document.querySelector('.table tbody');

				// Clear existing table rows
				tableBody.innerHTML = '';

				// Create a new row for each search result
				const newRow = document.createElement('tr');
				newRow.innerHTML = `
        <td class="px-4 py-2 border box-border text-center">${searchResult.student_name}</td>
            <td class="px-4 py-2 border box-border text-center">${searchResult.payment_date}</td>
            <td class="px-4 py-2 border box-border text-center">${searchResult.amount_paid}</td>
            <td class="px-4 py-2 border box-border text-center">${searchResult.student_class}</td>
            <td class="px-4 py-2 border box-border text-center">${searchResult.phone_number}</td>
    `;

				// Append the new row to the table body
				tableBody.appendChild(newRow);
			};

	//});
	</script>
</body>

</html>
